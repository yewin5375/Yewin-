<!DOCTYPE html>
<html lang="my">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Chicken BBQ Admin - Full Solution</title>
    
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>

    <header class="app-header">
        <div style="font-weight: 800; font-size: 1.2rem; color: #ff7043;">Chicken BBQ Admin</div>
        <div id="status-dot" style="font-size: 12px; color: #10b981;">‚óè System Online</div>
    </header>

    <main class="content-area">
        
        <section id="dashboard" class="view active">
            <h2 class="page-header">Daily Summary</h2>
            <div class="stat-grid">
                <div class="stat-card">
                    <small>Today Revenue</small>
                    <h3 id="stat-revenue">0 Ks</h3>
                </div>
                <div class="stat-card">
                    <small>New Orders</small>
                    <h3 id="stat-orders">0</h3>
                </div>
            </div>
            <div class="order-card-new">
                <canvas id="salesChart" height="180"></canvas>
            </div>
        </section>

        <section id="orders" class="view">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                <h2 class="page-header">Orders</h2>
                <button class="btn-status-step active" onclick="openPOS()">+ New Order</button>
            </div>
            
            <div class="category-scroll" style="margin-bottom: 15px;">
                <div class="cat-tab active" onclick="filterOrders('New')">New</div>
                <div class="cat-tab" onclick="filterOrders('Preparing')">Preparing</div>
                <div class="cat-tab" onclick="filterOrders('Ready')">Ready</div>
                <div class="cat-tab" onclick="filterOrders('Finished')">Finished</div>
            </div>

            <div id="order-list">
                </div>
        </section>

        <section id="menu-manager" class="view">
            <h2 class="page-header">Menu Gallery</h2>
            <div id="menu-list" class="menu-grid">
                </div>
            <button class="fab-add" onclick="openMenuModal()">+</button>
        </section>

        <section id="customers" class="view">
            <h2 class="page-header">VIP Customers</h2>
            <div class="search-wrapper">
                <input type="text" class="search-input-pearl" placeholder="·Äõ·Äæ·Ä¨·Äõ·Äî·Ä∫ (·Äñ·ÄØ·Äî·Ä∫·Ä∏/·Äî·Ä¨·Äô·Ää·Ä∫)..." oninput="searchCRM(this.value)">
            </div>
            <div id="customer-list" style="margin-top: 20px;">
                </div>
        </section>

    </main>

    <nav class="bottom-nav">
        <div class="nav-item active" onclick="showView('dashboard', this)">üìä</div>
        <div class="nav-item" onclick="showView('orders', this)">üì¶</div>
        <div class="nav-item" onclick="showView('menu-manager', this)">üç¥</div>
        <div class="nav-item" onclick="showView('customers', this)">üë•</div>
    </nav>

    <div id="menuModal" class="modal-overlay">
        <div class="menu-modal-content">
            <h3 id="menuModalTitle">Add New Item</h3>
            <input type="hidden" id="edit-id"> <div class="modal-input-group">
                <label>Item Name</label>
                <input type="text" id="m-name" placeholder="·Ä•·Äï·Äô·Ä¨- ·ÄÄ·Äº·ÄÄ·Ä∫·Äê·Ä±·Ä¨·ÄÑ·Ä∫·Äï·Ä∂·ÄÄ·ÄÑ·Ä∫">
            </div>
            <div class="modal-input-group">
                <label>Price (Ks)</label>
                <input type="number" id="m-price" placeholder="0">
            </div>
            <div class="modal-input-group">
                <label>Category</label>
                <select id="m-cat">
                    <option value="BBQ">BBQ</option>
                    <option value="Fried">·Ä°·ÄÄ·Äº·Ä±·Ä¨·Ä∫·ÄÖ·ÄØ·Ä∂</option>
                    <option value="Drink">·Ä°·Ä°·Ä±·Ä∏</option>
                </select>
            </div>
            <button class="confirm-btn" onclick="saveMenu()">Confirm & Save</button>
            <button onclick="closeModal('menuModal')" style="width:100%; border:none; background:none; margin-top:15px; color:#94a3b8;">Cancel</button>
        </div>
    </div>

    <div id="orderModal" class="modal-overlay">
        <div class="floating-window">
            <div class="pos-header">
                <h3 style="margin:0">Create New Order</h3>
                <button onclick="closeModal('orderModal')" class="delete-bin-btn">√ó</button>
            </div>
            <div class="pos-main-content">
                <div class="menu-container">
                    <input type="text" class="pos-input" placeholder="Search menu..." oninput="searchPOSMenu(this.value)">
                    <div id="pos-menu-grid" class="pos-menu-grid"></div>
                </div>
                
                <div class="cart-container">
                    <input type="text" id="cust-phone" class="pos-input" placeholder="Phone Number">
                    <input type="text" id="cust-name" class="pos-input" placeholder="Customer Name">
                    
                    <div style="display:flex; gap:10px;">
                        <select id="pay-method" class="pos-input">
                            <option value="Cash">Cash on Pick-up</option>
                            <option value="Prepaid">Pre-paid (Paid)</option>
                        </select>
                        <input type="time" id="pick-time" class="pos-input" title="Pick-up Time">
                    </div>

                    <div id="cart-items-list" style="flex:1; overflow-y:auto; margin-top:10px;">
                        </div>

                    <div class="checkout-bar">
                        <div id="total-amount-display" style="font-weight:800; font-size:1.1rem;">Total: 0 Ks</div>
                        <button class="btn-checkout" onclick="submitOrder()">Place Order</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="supabase.js"></script>
    <script src="app.js"></script>
    <script src="menu.js"></script>
    <script src="order.js"></script>
    <script src="customer.js"></script>

    <script>
        // View Navigation Logic
        function showView(viewId, element) {
            document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            document.getElementById(viewId).classList.add('active');
            element.classList.add('active');
            
            // Reload data
            if(viewId === 'orders') loadOrders('New');
            if(viewId === 'menu-manager') loadMenu();
            if(viewId === 'customers') loadCustomers();
            if(viewId === 'dashboard') updateDashboard();
        }

        function closeModal(id) { document.getElementById(id).style.display = 'none'; }
        function openPOS() { document.getElementById('orderModal').style.display = 'flex'; loadPOSMenu(); }
        function openMenuModal() { 
            document.getElementById('edit-id').value = ''; 
            document.getElementById('menuModalTitle').innerText = 'Add New Item';
            document.getElementById('menuModal').style.display = 'flex'; 
        }
    </script>
</body>
</html>

